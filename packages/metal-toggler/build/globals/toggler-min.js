(function(){this.metal=this.metal||{},this.metalNamed=this.metalNamed||{};var t={};t["typeof"]=function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},t.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},t.possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},function(){var e=function(){function e(){t.classCallCheck(this,e)}return e.abstractMethod=function(){throw Error("Unimplemented abstract method")},e.collectSuperClassesProperty=function(t,e){for(var n=[t[e]];t.__proto__&&!t.__proto__.isPrototypeOf(Function);)t=t.__proto__,n.push(t[e]);return n},e.getFunctionName=function(t){if(!t.name){var e=t.toString();t.name=e.substring(9,e.indexOf("("))}return t.name},e.getUid=function(t){return t?t[e.UID_PROPERTY]||(t[e.UID_PROPERTY]=e.uniqueIdCounter_++):e.uniqueIdCounter_++},e.identityFunction=function(t){return t},e.isBoolean=function(t){return"boolean"==typeof t},e.isDef=function(t){return void 0!==t},e.isDefAndNotNull=function(t){return e.isDef(t)&&!e.isNull(t)},e.isDocument=function(e){return e&&"object"===("undefined"==typeof e?"undefined":t["typeof"](e))&&9===e.nodeType},e.isElement=function(e){return e&&"object"===("undefined"==typeof e?"undefined":t["typeof"](e))&&1===e.nodeType},e.isFunction=function(t){return"function"==typeof t},e.isNull=function(t){return null===t},e.isNumber=function(t){return"number"==typeof t},e.isWindow=function(t){return null!==t&&t===t.window},e.isObject=function(e){var n="undefined"==typeof e?"undefined":t["typeof"](e);return"object"===n&&null!==e||"function"===n},e.isString=function(t){return"string"==typeof t},e.mergeSuperClassesProperty=function(t,n,r){var i=n+"_MERGED";if(t.hasOwnProperty(i))return!1;var o=e.collectSuperClassesProperty(t,n);return r&&(o=r(o)),t[i]=o,!0},e.nullFunction=function(){},e}();e.UID_PROPERTY="core_"+Date.now()%1e9+(1e9*Math.random()>>>0),e.uniqueIdCounter_=1,this.metal.core=e}.call(this),function(){var e=this.metal.core,n=function(){function n(){t.classCallCheck(this,n)}return n.mixin=function(t){for(var e,n,r=1;r<arguments.length;r++){n=arguments[r];for(e in n)t[e]=n[e]}return t},n.getObjectByName=function(t,n){for(var r,i=t.split("."),o=n||window;r=i.shift();){if(!e.isDefAndNotNull(o[r]))return null;o=o[r]}return o},n.map=function(t,e){for(var n={},r=Object.keys(t),i=0;i<r.length;i++)n[r[i]]=e(r[i],t[r[i]]);return n},n}();this.metal.object=n}.call(this),function(){var e=function(){function e(){t.classCallCheck(this,e),this.disposed_=!1}return e.prototype.dispose=function(){this.disposed_||(this.disposeInternal(),this.disposed_=!0)},e.prototype.disposeInternal=function(){},e.prototype.isDisposed=function(){return this.disposed_},e}();this.metal.Disposable=e}.call(this),function(){var e=this.metal.Disposable,n=function(e){function n(r,i,o){t.classCallCheck(this,n);var s=t.possibleConstructorReturn(this,e.call(this));return s.emitter_=r,s.event_=i,s.listener_=o,s}return t.inherits(n,e),n.prototype.disposeInternal=function(){this.removeListener(),this.emitter_=null,this.listener_=null},n.prototype.removeListener=function(){this.emitter_.isDisposed()||this.emitter_.removeListener(this.event_,this.listener_)},n}(e);n.prototype.registerMetalComponent&&n.prototype.registerMetalComponent(n,"EventHandle"),this.metal.EventHandle=n}.call(this),function(){var e=this.metal.EventHandle,n=function(e){function n(r,i,o,s){t.classCallCheck(this,n);var a=t.possibleConstructorReturn(this,e.call(this,r,i,o));return a.capture_=s,a}return t.inherits(n,e),n.prototype.removeListener=function(){this.emitter_.removeEventListener(this.event_,this.listener_,this.capture_)},n}(e);n.prototype.registerMetalComponent&&n.prototype.registerMetalComponent(n,"DomEventHandle"),this.metal.DomEventHandle=n}.call(this),function(){var e=this.metal.core,n=this.metal.object,r=this.metal.DomEventHandle,i=function(){function i(){t.classCallCheck(this,i)}return i.addClasses=function(t,n){e.isObject(t)&&e.isString(n)&&("classList"in t?i.addClassesWithNative_(t,n):i.addClassesWithoutNative_(t,n))},i.addClassesWithNative_=function(t,e){e.split(" ").forEach(function(e){t.classList.add(e)})},i.addClassesWithoutNative_=function(t,e){var n=" "+t.className+" ",r="";e=e.split(" ");for(var i=0;i<e.length;i++){var o=e[i];-1===n.indexOf(" "+o+" ")&&(r+=" "+o)}r&&(t.className=t.className+r)},i.append=function(t,n){if(e.isString(n)&&(n=i.buildFragment(n)),n instanceof NodeList)for(var r=Array.prototype.slice.call(n),o=0;o<r.length;o++)t.appendChild(r[o]);else t.appendChild(n);return n},i.buildFragment=function(t){var e=document.createElement("div");e.innerHTML="<br>"+t,e.removeChild(e.firstChild);for(var n=document.createDocumentFragment();e.firstChild;)n.appendChild(e.firstChild);return n},i.contains=function(t,n){return e.isDocument(t)?t.documentElement.contains(n):t.contains(n)},i.delegate=function(t,e,n,r){var o=i.customEvents[e];return o&&o.delegate&&(e=o.originalEvent,r=o.handler.bind(o,r)),i.on(t,e,i.handleDelegateEvent_.bind(null,n,r))},i.enterDocument=function(t){i.append(document.body,t)},i.exitDocument=function(t){t.parentNode&&t.parentNode.removeChild(t)},i.handleDelegateEvent_=function(t,n,r){i.normalizeDelegateEvent_(r);for(var o=r.target,s=!0;o&&!r.stopped&&(e.isString(t)&&i.match(o,t)&&(r.delegateTarget=o,s&=n(r)),o!==r.currentTarget);)o=o.parentNode;return r.delegateTarget=null,s},i.hasClass=function(t,e){return"classList"in t?i.hasClassWithNative_(t,e):i.hasClassWithoutNative_(t,e)},i.hasClassWithNative_=function(t,e){return t.classList.contains(e)},i.hasClassWithoutNative_=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")>=0},i.isEmpty=function(t){return 0===t.childNodes.length},i.match=function(t,e){if(!t||1!==t.nodeType)return!1;var n=Element.prototype,r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return r?r.call(t,e):i.matchFallback_(t,e)},i.matchFallback_=function(t,e){for(var n=document.querySelectorAll(e,t.parentNode),r=0;r<n.length;++r)if(n[r]===t)return!0;return!1},i.next=function(t,e){do if(t=t.nextSibling,t&&i.match(t,e))return t;while(t);return null},i.normalizeDelegateEvent_=function(t){t.stopPropagation=i.stopPropagation_,t.stopImmediatePropagation=i.stopImmediatePropagation_},i.on=function(t,n,o,s){if(e.isString(t))return i.delegate(document,n,t,o);var a=i.customEvents[n];return a&&a.event&&(n=a.originalEvent,o=a.handler.bind(a,o)),t.addEventListener(n,o,s),new r(t,n,o,s)},i.once=function(t,e,n){var r=this.on(t,e,function(){return r.removeListener(),n.apply(this,arguments)});return r},i.registerCustomEvent=function(t,e){i.customEvents[t]=e},i.removeChildren=function(t){for(var e;e=t.firstChild;)t.removeChild(e)},i.removeClasses=function(t,n){e.isObject(t)&&e.isString(n)&&("classList"in t?i.removeClassesWithNative_(t,n):i.removeClassesWithoutNative_(t,n))},i.removeClassesWithNative_=function(t,e){e.split(" ").forEach(function(e){t.classList.remove(e)})},i.removeClassesWithoutNative_=function(t,e){var n=" "+t.className+" ";e=e.split(" ");for(var r=0;r<e.length;r++)n=n.replace(" "+e[r]+" "," ");t.className=n.trim()},i.replace=function(t,e){t&&e&&t!==e&&t.parentNode&&(t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t))},i.stopImmediatePropagation_=function(){this.stopped=!0,Event.prototype.stopImmediatePropagation.call(this)},i.stopPropagation_=function(){this.stopped=!0,Event.prototype.stopPropagation.call(this)},i.supportsEvent=function(t,n){return i.customEvents[n]?!0:(e.isString(t)&&(o[t]||(o[t]=document.createElement(t)),t=o[t]),"on"+n in t)},i.toElement=function(t){return e.isElement(t)||e.isDocument(t)?t:e.isString(t)?"#"===t[0]&&-1===t.indexOf(" ")?document.getElementById(t.substr(1)):document.querySelector(t):null},i.toggleClasses=function(t,n){e.isObject(t)&&e.isString(n)&&("classList"in t?i.toggleClassesWithNative_(t,n):i.toggleClassesWithoutNative_(t,n))},i.toggleClassesWithNative_=function(t,e){e.split(" ").forEach(function(e){t.classList.toggle(e)})},i.toggleClassesWithoutNative_=function(t,e){var n=" "+t.className+" ";e=e.split(" ");for(var r=0;r<e.length;r++){var i=" "+e[r]+" ",o=n.indexOf(i);n=-1===o?n+e[r]+" ":n.substring(0,o)+" "+n.substring(o+i.length)}t.className=n.trim()},i.triggerEvent=function(t,e,r){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),n.mixin(i,r),t.dispatchEvent(i)},i}(),o={};i.customEvents={},this.metal.dom=i}.call(this),function(){var e=this.metal.core,n=function(){function n(){t.classCallCheck(this,n)}return n.equal=function(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return t.length===e.length},n.firstDefinedValue=function(t){for(var e=0;e<t.length;e++)if(void 0!==t[e])return t[e]},n.flatten=function(t,e){for(var r=e||[],i=0;i<t.length;i++)Array.isArray(t[i])?n.flatten(t[i],r):r.push(t[i]);return r},n.remove=function(t,e){var r,i=t.indexOf(e);return(r=i>=0)&&n.removeAt(t,i),r},n.removeAt=function(t,e){return 1===Array.prototype.splice.call(t,e,1).length},n.slice=function(t,n,r){for(var i=[],o=e.isDef(r)?r:t.length,s=n;o>s;s++)i.push(t[s]);return i},n}();this.metal.array=n}.call(this),function(){var e=this.metal.core,n=this.metal.array,r=this.metal.Disposable,i=this.metal.EventHandle,o=function(r){function o(){t.classCallCheck(this,o);var e=t.possibleConstructorReturn(this,r.call(this));return e.events_=[],e.maxListeners_=10,e.shouldUseFacade_=!1,e}return t.inherits(o,r),o.prototype.addListener=function(t,e,n){this.validateListener_(e),t=this.normalizeEvents_(t);for(var r=0;r<t.length;r++)this.addSingleListener_(t[r],e,n);return new i(this,t,e)},o.prototype.addSingleListener_=function(t,e,n,r){this.emit("newListener",t,e),this.events_[t]||(this.events_[t]=[]),this.events_[t].push({"default":n,fn:e,origin:r});var i=this.events_[t];i.length>this.maxListeners_&&!i.warned&&(i.warned=!0)},o.prototype.disposeInternal=function(){this.events_=[]},o.prototype.emit=function(t){var e,r=n.slice(arguments,1),i=(this.events_[t]||[]).concat();this.getShouldUseFacade()&&(e={preventDefault:function(){e.preventedDefault=!0},target:this,type:t},r.push(e));for(var o=[],s=0;s<i.length;s++)i[s]["default"]?o.push(i[s]):i[s].fn.apply(this,r);if(!e||!e.preventedDefault)for(var a=0;a<o.length;a++)o[a].fn.apply(this,r);return"*"!==t&&this.emit.apply(this,["*",t].concat(r)),i.length>0},o.prototype.getShouldUseFacade=function(){return this.shouldUseFacade_},o.prototype.listeners=function(t){return(this.events_[t]||[]).map(function(t){return t.fn})},o.prototype.many=function(t,e,n){t=this.normalizeEvents_(t);for(var r=0;r<t.length;r++)this.many_(t[r],e,n);return new i(this,t,n)},o.prototype.many_=function(t,e,n){function r(){0===--e&&i.removeListener(t,r),n.apply(i,arguments)}var i=this;0>=e||i.addSingleListener_(t,r,!1,n)},o.prototype.matchesListener_=function(t,e){return t.fn===e||t.origin&&t.origin===e},o.prototype.normalizeEvents_=function(t){return e.isString(t)?[t]:t},o.prototype.off=function(t,e){this.validateListener_(e),t=this.normalizeEvents_(t);for(var n=0;n<t.length;n++){var r=this.events_[t[n]]||[];this.removeMatchingListenerObjs_(r,e)}return this},o.prototype.on=function(){return this.addListener.apply(this,arguments)},o.prototype.once=function(t,e){return this.many(t,1,e)},o.prototype.removeAllListeners=function(t){if(t)for(var e=this.normalizeEvents_(t),n=0;n<e.length;n++)this.events_[e[n]]=null;else this.events_={};return this},o.prototype.removeMatchingListenerObjs_=function(t,e){for(var n=t.length-1;n>=0;n--)this.matchesListener_(t[n],e)&&t.splice(n,1)},o.prototype.removeListener=function(){return this.off.apply(this,arguments)},o.prototype.setMaxListeners=function(t){return this.maxListeners_=t,this},o.prototype.setShouldUseFacade=function(t){return this.shouldUseFacade_=t,this},o.prototype.validateListener_=function(t){if(!e.isFunction(t))throw new TypeError("Listener must be a function")},o}(r);o.prototype.registerMetalComponent&&o.prototype.registerMetalComponent(o,"EventEmitter"),this.metal.EventEmitter=o}.call(this),function(){var t={};t.throwException=function(e){t.nextTick(function(){throw e})},t.run=function(e,n){t.run.workQueueScheduled_||(t.nextTick(t.run.processWorkQueue),t.run.workQueueScheduled_=!0),t.run.workQueue_.push(new t.run.WorkItem_(e,n))},t.run.workQueueScheduled_=!1,t.run.workQueue_=[],t.run.processWorkQueue=function(){for(;t.run.workQueue_.length;){var e=t.run.workQueue_;t.run.workQueue_=[];for(var n=0;n<e.length;n++){var r=e[n];try{r.fn.call(r.scope)}catch(i){t.throwException(i)}}}t.run.workQueueScheduled_=!1},t.run.WorkItem_=function(t,e){this.fn=t,this.scope=e},t.nextTick=function(e,n){var r=e;return n&&(r=e.bind(n)),r=t.nextTick.wrapCallback_(r),"function"==typeof setImmediate?void setImmediate(r):(t.nextTick.setImmediate_||(t.nextTick.setImmediate_=t.nextTick.getSetImmediateEmulator_()),void t.nextTick.setImmediate_(r))},t.nextTick.setImmediate_=null,t.nextTick.getSetImmediateEmulator_=function(){var t;if("function"==typeof MessageChannel&&(t=MessageChannel),"undefined"==typeof t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(t=function(){var t=document.createElement("iframe");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow,n=e.document;n.open(),n.write(""),n.close();var r="callImmediate"+Math.random(),i=e.location.protocol+"//"+e.location.host,o=function(t){(t.origin===i||t.data===r)&&this.port1.onmessage()}.bind(this);e.addEventListener("message",o,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(r,i)}}}),"undefined"!=typeof t){var e=new t,n={},r=n;return e.port1.onmessage=function(){n=n.next;var t=n.cb;n.cb=null,t()},function(t){r.next={cb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(t){var e=document.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){setTimeout(t,0)}},t.nextTick.wrapCallback_=function(t){return t},this.metal.async=t}.call(this),function(){var e=this.metal.array,n=this.metal.core,r=this.metal.object,i=this.metal.EventEmitter,o=this.metal.async,s=function(i){function s(e){t.classCallCheck(this,s);var n=t.possibleConstructorReturn(this,i.call(this));return n.scheduledBatchData_=null,n.attrsInfo_={},n.setShouldUseFacade(!0),n.mergeInvalidAttrs_(),n.addAttrsFromStaticHint_(e),n}return t.inherits(s,i),s.prototype.addAttr=function(t,e,n){this.buildAttrInfo_(t,e,n),Object.defineProperty(this,t,this.buildAttrPropertyDef_(t))},s.prototype.addAttrs=function(t,e,n){e=e||{};for(var r=Object.keys(t),i={},o=0;o<r.length;o++){var s=r[o];this.buildAttrInfo_(s,t[s],e[s]),i[s]=this.buildAttrPropertyDef_(s)}n!==!1&&Object.defineProperties(n||this,i)},s.prototype.addAttrsFromStaticHint_=function(t){var e=this.constructor,n=!1;s.mergeAttrsStatic(e)&&(n=e.prototype),this.addAttrs(e.ATTRS_MERGED,t,n)},s.prototype.assertValidAttrName_=function(t){if(this.constructor.INVALID_ATTRS_MERGED[t])throw new Error("It's not allowed to create an attribute with the name \""+t+'".')},s.prototype.buildAttrInfo_=function(t,e,n){this.assertValidAttrName_(t),this.attrsInfo_[t]={config:e||{},initialValue:n,state:s.States.UNINITIALIZED}},s.prototype.buildAttrPropertyDef_=function(t){return{configurable:!0,enumerable:!0,get:function(){return this.getAttrValue_(t)},set:function(e){this.setAttrValue_(t,e)}}},s.prototype.callFunction_=function(t,e){return n.isString(t)?this[t].apply(this,e):n.isFunction(t)?t.apply(this,e):void 0},s.prototype.callSetter_=function(t,e){var n=this.attrsInfo_[t],r=n.config;return r.setter&&(e=this.callFunction_(r.setter,[e])),e},s.prototype.callValidator_=function(t,e){var n=this.attrsInfo_[t],r=n.config;return r.validator?this.callFunction_(r.validator,[e]):!0},s.prototype.canSetAttribute=function(t){var e=this.attrsInfo_[t];return!e.config.writeOnce||!e.written},s.prototype.disposeInternal=function(){i.prototype.disposeInternal.call(this),this.attrsInfo_=null,this.scheduledBatchData_=null},s.prototype.emitBatchEvent_=function(){if(!this.isDisposed()){var t=this.scheduledBatchData_;this.scheduledBatchData_=null,this.emit("attrsChanged",t)}},s.prototype.get=function(t){return this[t]},s.prototype.getAttrConfig=function(t){return(this.attrsInfo_[t]||{}).config},s.prototype.getAttrs=function(t){for(var e={},n=t||this.getAttrNames(),r=0;r<n.length;r++)e[n[r]]=this[n[r]];return e},s.prototype.getAttrNames=function(){return Object.keys(this.attrsInfo_)},s.prototype.getAttrValue_=function(t){return this.initAttr_(t),this.attrsInfo_[t].value},s.prototype.informChange_=function(t,e){if(this.shouldInformChange_(t,e)){var n={attrName:t,newVal:this[t],prevVal:e};this.emit(t+"Changed",n),this.scheduleBatchEvent_(n)}},s.prototype.initAttr_=function(t){var e=this.attrsInfo_[t];e.state===s.States.UNINITIALIZED&&(e.state=s.States.INITIALIZING,this.setInitialValue_(t),e.written||(e.state=s.States.INITIALIZING_DEFAULT,this.setDefaultValue_(t)),e.state=s.States.INITIALIZED)},s.mergeAttrs_=function(t){return r.mixin.apply(null,[{}].concat(t.reverse()))},s.mergeAttrsStatic=function(t){return n.mergeSuperClassesProperty(t,"ATTRS",s.mergeAttrs_)},s.prototype.mergeInvalidAttrs_=function(){n.mergeSuperClassesProperty(this.constructor,"INVALID_ATTRS",function(t){return e.flatten(t).reduce(function(t,e){return e&&(t[e]=!0),t},{})})},s.prototype.removeAttr=function(t){this.attrsInfo_[t]=null,delete this[t]},s.prototype.scheduleBatchEvent_=function(t){this.scheduledBatchData_||(o.nextTick(this.emitBatchEvent_,this),this.scheduledBatchData_={changes:{}});var e=t.attrName,n=this.scheduledBatchData_.changes;n[e]?n[e].newVal=t.newVal:n[e]=t},s.prototype.set=function(t,e){this[t]=e},s.prototype.setAttrs=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)this[e[n]]=t[e[n]]},s.prototype.setAttrValue_=function(t,e){if(this.canSetAttribute(t)&&this.validateAttrValue_(t,e)){var n=this.attrsInfo_[t];void 0===n.initialValue&&n.state===s.States.UNINITIALIZED&&(n.state=s.States.INITIALIZED);var r=this[t];n.value=this.callSetter_(t,e),n.written=!0,this.informChange_(t,r)}},s.prototype.setDefaultValue_=function(t){var e=this.attrsInfo_[t].config;void 0!==e.value?this[t]=e.value:this[t]=this.callFunction_(e.valueFn)},s.prototype.setInitialValue_=function(t){var e=this.attrsInfo_[t];void 0!==e.initialValue&&(this[t]=e.initialValue,e.initialValue=void 0)},s.prototype.shouldInformChange_=function(t,e){var r=this.attrsInfo_[t];return r.state===s.States.INITIALIZED&&(n.isObject(e)||e!==this[t])},s.prototype.validateAttrValue_=function(t,e){var n=this.attrsInfo_[t];return n.state===s.States.INITIALIZING_DEFAULT||this.callValidator_(t,e)},s}(i);s.prototype.registerMetalComponent&&s.prototype.registerMetalComponent(s,"Attribute"),s.INVALID_ATTRS=["attrs"],s.States={UNINITIALIZED:0,INITIALIZING:1,INITIALIZING_DEFAULT:2,INITIALIZED:3},this.metal.Attribute=s}.call(this),function(){var e=this.metal.Disposable,n=function(e){function n(){t.classCallCheck(this,n);var r=t.possibleConstructorReturn(this,e.call(this));return r.eventHandles_=[],r}return t.inherits(n,e),n.prototype.add=function(){for(var t=0;t<arguments.length;t++)this.eventHandles_.push(arguments[t])},n.prototype.disposeInternal=function(){this.eventHandles_=null},n.prototype.removeAllListeners=function(){for(var t=0;t<this.eventHandles_.length;t++)this.eventHandles_[t].removeListener();this.eventHandles_=[]},n}(e);n.prototype.registerMetalComponent&&n.prototype.registerMetalComponent(n,"EventHandler"),this.metal.EventHandler=n}.call(this),function(){var e=this.metal.core,n=this.metal.dom,r=this.metal.Attribute,i=this.metal.EventHandler,o=function(r){function o(e){t.classCallCheck(this,o);var n=t.possibleConstructorReturn(this,r.call(this,e));return n.headerEventHandler_=new i,n.on("headerChanged",n.syncHeader),n.syncHeader(),n}return t.inherits(o,r),o.prototype.disposeInternal=function(){r.prototype.disposeInternal.call(this),this.headerEventHandler_.removeAllListeners()},o.prototype.getContentElement_=function(t){if(e.isElement(this.content))return this.content;var r=n.next(t,this.content);return r?r:(r=t.querySelector(this.content),r?r:this.container.querySelector(this.content))},o.prototype.handleClick_=function(t){this.toggle(t.delegateTarget||t.currentTarget)},o.prototype.handleKeydown_=function(t){(13===t.keyCode||32===t.keyCode)&&(this.toggle(t.delegateTarget||t.currentTarget),t.preventDefault())},o.prototype.syncHeader=function(){this.headerEventHandler_.removeAllListeners(),this.header&&(e.isString(this.header)?this.headerEventHandler_.add(n.delegate(this.container,"click",this.header,this.handleClick_.bind(this)),n.delegate(this.container,"keydown",this.header,this.handleKeydown_.bind(this))):this.headerEventHandler_.add(n.on(this.header,"click",this.handleClick_.bind(this)),n.on(this.header,"keydown",this.handleKeydown_.bind(this))))},o.prototype.toggle=function(t){var e=this.getContentElement_(t);n.toggleClasses(e,o.CSS_EXPANDED),n.toggleClasses(e,o.CSS_COLLAPSED),n.hasClass(e,o.CSS_EXPANDED)?(n.addClasses(t,o.CSS_HEADER_EXPANDED),n.removeClasses(t,o.CSS_HEADER_COLLAPSED)):(n.removeClasses(t,o.CSS_HEADER_EXPANDED),n.addClasses(t,o.CSS_HEADER_COLLAPSED))},o}(r);o.prototype.registerMetalComponent&&o.prototype.registerMetalComponent(o,"Toggler"),o.ATTRS={container:{setter:n.toElement,validator:function(t){return e.isString(t)||e.isElement(t)},value:document},content:{validator:function(t){return e.isString(t)||e.isElement(t)}},header:{validator:function(t){return e.isString(t)||e.isElement(t)}}},o.CSS_COLLAPSED="toggler-collapsed",o.CSS_EXPANDED="toggler-expanded",o.CSS_HEADER_COLLAPSED="toggler-header-collapsed",o.CSS_HEADER_EXPANDED="toggler-header-expanded",this.metal.Toggler=o}.call(this)}).call(this);